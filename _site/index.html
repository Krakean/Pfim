<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Pfim | C# fast image decoder that can work targa (.tga) and direct draw surface (.dds) images</title>
<meta property="og:title" content="Pfim" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="C# fast image decoder that can work targa (.tga) and direct draw surface (.dds) images" />
<meta property="og:description" content="C# fast image decoder that can work targa (.tga) and direct draw surface (.dds) images" />
<link rel="canonical" href="http://0.0.0.0:4000/" />
<meta property="og:url" content="http://0.0.0.0:4000/" />
<meta property="og:site_name" content="Pfim" />
<script type="application/ld+json">
{"name":"Pfim","description":"C# fast image decoder that can work targa (.tga) and direct draw surface (.dds) images","url":"http://0.0.0.0:4000/","headline":"Pfim","dateModified":null,"datePublished":null,"sameAs":null,"@type":"WebSite","author":null,"image":null,"publisher":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="description" content="C# fast image decoder that can work targa (.tga) and direct draw surface (.dds) images
"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=HEAD">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Pfim</h1>
      <h2 class="project-tagline">C# fast image decoder that can work targa (.tga) and direct draw surface (.dds) images
</h2>
      
        <a href="http://github.com/nickbabcock/Pfim" class="btn">View on GitHub</a>
      
      
    </section>

    <section class="main-content">
      <p><a href="/pfim-viewer.png"><img src="pfim-viewer.png" alt="Pfim-viewer" /></a></p>

<p><em>A sample WPF interface that uses the Pfim library to load Targa and DDS images. Images are not my own</em></p>

<h2 id="motivation">Motivation</h2>

<p>I needed a C# <a href="https://en.wikipedia.org/wiki/Truevision_TGA">Targa</a> and
<a href="https://en.wikipedia.org/wiki/DirectDraw_Surface">Direct Draw Surface (DDS)</a>
decoder and the ones out there didn’t satisfy my needs, so I wrote my own.</p>

<p>Pfim fills this role by being entirely written in .NET (eases cross platform
worries) with an easy to learn API. Pfim also clocks in as one of the fastest
(if not the fastest) implementation. See the benchmarks for more information.</p>

<h2 id="installation">Installation</h2>

<p><a href="http://www.nuget.org/packages/Pfim/">Install from NuGet</a></p>

<h2 id="usage">Usage</h2>

<p>Pfim emphasizes on being frontend and backend agnostic. This means that you
can add Pfim to your server, Windows Form, or WPF app! The downside is that
you may have to put in a little work to get into a useable form, but as you’ll
see it is not that hard!</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="c1">// Load image from file path
</span><span class="n">IImage</span> <span class="n">image</span> <span class="p">=</span> <span class="n">Pfim</span><span class="p">.</span><span class="nf">FromFile</span><span class="p">(</span><span class="s">@"C:\image.tga"</span><span class="p">);</span></code></pre></figure>

<p>If one already has the data stream and knows the format, each format can be directly called:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="c1">// Obtain a stream of data somehow
</span><span class="kt">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">();</span>

<span class="c1">// Creates a direct draw surface image
</span><span class="n">IImage</span> <span class="n">image</span> <span class="p">=</span> <span class="n">Dds</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">stream</span><span class="p">);</span>

<span class="c1">// Creates a targa image
</span><span class="n">IImage</span> <span class="n">image2</span> <span class="p">=</span> <span class="n">Targa</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">stream</span><span class="p">);</span></code></pre></figure>

<h2 id="benchmarks">Benchmarks</h2>

<p>The following contestants:</p>

<ul>
  <li>Pfim</li>
  <li><a href="http://openil.sourceforge.net/">DevIL</a></li>
  <li><a href="http://freeimage.sourceforge.net/">FreeImage</a></li>
  <li><a href="https://www.imagemagick.org/script/index.php">ImageMagick</a></li>
  <li><a href="https://www.codeproject.com/Articles/31702/NET-Targa-Image-Reader">TargaImage</a></li>
</ul>

<p><strong>Caveat</strong>: These libraries do much more than decode images, and may not have the time or want the sacrifice that may come with optimizing the decoding process.</p>

<p>These libraries competed in decoding the following images:</p>

<ul>
  <li>A large (1200x1200) 24bit (no alpha component) targa image</li>
  <li>A small (64x64) 24bit (no alpha component) targa image</li>
  <li>A large (1200x1200) 32bit run length encoded (RLE) targa image</li>
  <li>A small (64x64) 32bit run length encoded (RLE) targa image</li>
  <li>A small (64x64) uncompressed DDS image</li>
  <li>A small (64x64) DXT1 encoded DDS image</li>
  <li>A small (64x64) DXT3 encoded DDS image</li>
  <li>A small (64x64) DXT5 encoded DDS image</li>
</ul>

<p><a href="/benchmark.png"><img src="/benchmark.png" alt="Pfim-benchmark1" /></a></p>

<p>The light blue is Pfim. Notice that it sets the record for highest throughput for each category relative to all the other decoders benchmarked.</p>

<p>The benchmarking was done through <a href="https://github.com/dotnet/BenchmarkDotNet">Benchmarkdotnet</a> and the benchmark code can
be found in the repo.</p>

<h2 id="integrations">Integrations</h2>

<p>Since Pfim is backend and frontend agnostic, one has to write the appropriate translations. Below is the WPF specific code, which can be seen in the Pfim.Viewer sample project in the source code.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">private</span> <span class="k">static</span> <span class="n">BitmapSource</span> <span class="nf">LoadImage</span><span class="p">(</span><span class="n">IImage</span> <span class="n">image</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">PixelFormat</span> <span class="n">format</span><span class="p">;</span>
    <span class="k">switch</span> <span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">Format</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">case</span> <span class="n">ImageFormat</span><span class="p">.</span><span class="n">Rgb24</span><span class="p">:</span>
            <span class="n">format</span> <span class="p">=</span> <span class="n">PixelFormats</span><span class="p">.</span><span class="n">Bgr24</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>

        <span class="k">case</span> <span class="n">ImageFormat</span><span class="p">.</span><span class="n">Rgba32</span><span class="p">:</span>
            <span class="n">format</span> <span class="p">=</span> <span class="n">PixelFormats</span><span class="p">.</span><span class="n">Bgr32</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>

        <span class="k">default</span><span class="p">:</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">"Format not recognized"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Create a WPF ImageSource and then set an Image to our variable.
</span>    <span class="c1">// Make sure you notify property changes as appropriate ;)
</span>    <span class="k">return</span> <span class="n">BitmapSource</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">image</span><span class="p">.</span><span class="n">Height</span><span class="p">,</span>
        <span class="m">96.0</span><span class="p">,</span> <span class="m">96.0</span><span class="p">,</span> <span class="n">format</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">image</span><span class="p">.</span><span class="n">Data</span><span class="p">,</span> <span class="n">image</span><span class="p">.</span><span class="n">Stride</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<h2 id="release-notes">Release Notes</h2>

<h3 id="040---unreleased">0.4.0 - Unreleased</h3>
<ul>
  <li>Released for netstandard 1.3</li>
  <li>25% performance improvement on compressed dds images</li>
  <li>Bugfix in compressed targa decoder</li>
</ul>

<h3 id="031---august-18th-2015">0.3.1 - August 18th 2015</h3>
<ul>
  <li>Fix pixel depth calculations for compressed dds</li>
</ul>

<h3 id="03---april-30-2015">0.3 - April 30 2015</h3>
<ul>
  <li>Internalized a lot of API to simplify usage</li>
  <li>Publish benchmarking</li>
</ul>

<h3 id="02---april-29-2015">0.2 - April 29 2015</h3>
<ul>
  <li>All decoded images now derive from <code class="highlighter-rouge">IImage</code></li>
</ul>

<h3 id="01---april-26-2015">0.1 - April 26 2015</h3>
<ul>
  <li>Initial release</li>
</ul>


      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="http://github.com/nickbabcock/Pfim">Pfim</a> is maintained by <a href="http://github.com/nickbabcock">nickbabcock</a>.</span>
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </section>

    
  </body>
</html>
